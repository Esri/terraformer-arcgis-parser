!function(a,b){if("object"==typeof module&&"object"==typeof module.exports&&(exports=module.exports=b(require("terraformer"))),"object"==typeof a.navigator){if(!a.Terraformer)throw new Error("Terraformer.ArcGIS requires the core Terraformer library. https://github.com/esri/Terraformer");a.Terraformer.ArcGIS=b(a.Terraformer)}}(this,function(a){function b(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function c(a){var b,c=0,d=0,e=a.length,f=a[d];for(d;e-1>d;d++)b=a[d+1],c+=(b[0]-f[0])*(b[1]+f[1]),f=b;return c>=0}function d(a){var b=[],d=a.slice(0),e=d.shift().slice(0);c(e)||e.reverse(),b.push(e);for(var f=0;f<d.length;f++){var g=d[f].slice(0);c(g)&&g.reverse(),b.push(g)}return b}function e(a){for(var b=[],c=0;c<a.length;c++)for(var e=d(a[c]),f=e.length-1;f>=0;f--){var g=e[f].slice(0);b.push(g)}return b}function f(b,c){var d=a.Tools.arrayIntersectsArray(b,c),e=a.Tools.coordinatesContainPoint(b,c[0]);return!d&&e?!0:!1}function g(a){for(var b=[],d=[],e=0;e<a.length;e++){var g=a[e].slice(0);if(c(g)){var h=[g];b.push(h)}else d.push(g)}for(;d.length;){for(var i=d.pop(),j=!1,k=b.length-1;k>=0;k--){var l=b[k][0];if(f(l,i)){b[k].push(i),j=!0;break}}j||b.push([i.reverse()])}return 1===b.length?{type:"Polygon",coordinates:b[0]}:{type:"MultiPolygon",coordinates:b}}function h(c,d){var e={};d=d||{},d.idAttribute=d.idAttribute||void 0,c.x&&c.y&&(e.type="Point",e.coordinates=[c.x,c.y]),c.points&&(e.type="MultiPoint",e.coordinates=c.points.slice(0)),c.paths&&(1===c.paths.length?(e.type="LineString",e.coordinates=c.paths[0].slice(0)):(e.type="MultiLineString",e.coordinates=c.paths.slice(0))),c.rings&&(e=g(c.rings.slice(0))),(c.geometry||c.attributes)&&(e.type="Feature",e.geometry=c.geometry?h(c.geometry):null,e.properties=c.attributes?b(c.attributes):null,c.attributes&&(e.id=c.attributes[d.idAttribute]||c.attributes.OBJECTID||c.attributes.FID));var f=c.geometry?c.geometry.spatialReference:c.spatialReference;return f&&102100===f.wkid&&(e=a.toGeographic(e)),new a.Primitive(e)}function i(c,f){var g;f=f||{};var h=f.idAttribute||"OBJECTID";g=f.sr?{wkid:sr}:c&&c.crs===a.MercatorCRS?{wkid:102100}:{wkid:4326};var j,k={};switch(c.type){case"Point":k.x=c.coordinates[0],k.y=c.coordinates[1],k.spatialReference=g;break;case"MultiPoint":k.points=c.coordinates.slice(0),k.spatialReference=g;break;case"LineString":k.paths=[c.coordinates.slice(0)],k.spatialReference=g;break;case"MultiLineString":k.paths=c.coordinates.slice(0),k.spatialReference=g;break;case"Polygon":k.rings=d(c.coordinates.slice(0)),k.spatialReference=g;break;case"MultiPolygon":k.rings=e(c.coordinates.slice(0)),k.spatialReference=g;break;case"Feature":c.geometry&&(k.geometry=i(c.geometry)),k.attributes=c.properties?b(c.properties):{},k.attributes[h]=c.id;break;case"FeatureCollection":for(k=[],j=0;j<c.features.length;j++)k.push(i(c.features[j],f));break;case"GeometryCollection":for(k=[],j=0;j<c.geometries.length;j++)k.push(i(c.geometries[j],f))}return k}var j={};return j.parse=h,j.convert=i,j.toGeoJSON=h,j.fromGeoJSON=i,j});