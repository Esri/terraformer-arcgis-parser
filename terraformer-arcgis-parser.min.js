!function(a,b){if("object"==typeof module&&"object"==typeof module.exports&&(exports=module.exports=b(require("terraformer"))),"object"==typeof a.navigator){if(!a.Terraformer)throw new Error("Terraformer.ArcGIS requires the core Terraformer library. https://github.com/esri/Terraformer");a.Terraformer.ArcGIS=b(a.Terraformer)}}(this,function(a){function b(a){var b,c=0,d=0,e=a.length,f=a[d];for(d;e-1>d;d++)b=a[d+1],c+=(b[0]-f[0])*(b[1]+f[1]),f=b;return c>=0}function c(a){var c=[],d=a.shift();b(d)||d.reverse(),c.push(d);for(var e=0;e<a.length;e++){var f=a[e];b(f)&&d.reverse(),c.push(a[e])}return c}function d(a){for(var b=[],d=0;d<a.length;d++){for(var e=c(a[d]),f=e.length-1;f>=0;f--){var g=e[f];b.push(g)}b.push()}return b}function e(b,c){var d=a.Tools.arrayIntersectsArray(b,c),e=a.Tools.coordinatesContainPoint(b,c[0]);return!d&&e?!0:!1}function f(a){for(var c=[],d=[],f=0;f<a.length;f++){var g=a[f];if(b(g)){var h=[g];c.push(h)}else d.push(g)}for(;d.length;){for(var i=d.pop(),j=!1,k=c.length-1;k>=0;k--){var l=c[k][0];if(e(l,i)){c[k].push(i),j=!0;break}}j||c.push([i.reverse()])}return 1===c.length?{type:"Polygon",coordinates:c[0]}:{type:"MultiPolygon",coordinates:c}}function g(b){var c=JSON.parse(JSON.stringify(b)),d={};c.x&&c.y&&(d.type="Point",d.coordinates=[c.x,c.y]),c.points&&(d.type="MultiPoint",d.coordinates=c.points),c.paths&&(1===c.paths.length?(d.type="LineString",d.coordinates=c.paths[0]):(d.type="MultiLineString",d.coordinates=c.paths)),c.rings&&(d=f(c.rings)),c.geometry&&(d.type="Feature",d.geometry=g(c.geometry),d.properties=c.attributes||{});var e=c.geometry?c.geometry.spatialReference:c.spatialReference;return e&&102100===e.wkid&&(d=a.toGeographic(d)),new a.Primitive(d)}function h(b,e){var f,g=JSON.parse(JSON.stringify(b));f=e?e:g.crs===a.MercatorCRS?{wkid:102100}:{wkid:4326};var i,j={};switch(g.type){case"Point":j.x=g.coordinates[0],j.y=g.coordinates[1],j.spatialReference=f;break;case"MultiPoint":j.points=g.coordinates,j.spatialReference=f;break;case"LineString":j.paths=[g.coordinates],j.spatialReference=f;break;case"MultiLineString":j.paths=g.coordinates,j.spatialReference=f;break;case"Polygon":j.rings=c(g.coordinates),j.spatialReference=f;break;case"MultiPolygon":j.rings=d(g.coordinates),j.spatialReference=f;break;case"Feature":j.geometry=h(g.geometry),j.attributes=g.properties;break;case"FeatureCollection":for(j=[],i=0;i<g.features.length;i++)j.push(h(g.features[i]));break;case"GeometryCollection":for(j=[],i=0;i<g.geometries.length;i++)j.push(h(g.geometries[i]))}return j}var i={};return i.parse=g,i.convert=h,i.toGeoJSON=g,i.fromGeoJSON=h,i});